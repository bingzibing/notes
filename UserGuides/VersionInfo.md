# 版本

## 1、版本信息展示查询

* 点击版本管理下的**版本**页面，该页面展示了所有版本的信息。依次选择产品名、设备名和模块名可以对版本信息进行筛选查询。另外，输入版本信息中的关键字，可以根据版本字段来模糊查询版本信息数据，如输入0.20可以查询出三条版本信息数据。

![版本信息模糊查询图](..\resource\versionInfoImg\版本信息模糊查询图.png)

## 2、添加版本信息(手动上传)

* 点击版本页面上的**添加版本**按钮，依次填入产品名、设备名、模块名和版本，并上传软件包，可以添加一条版本信息数据，添加完成之后数据会在页面上展示出来。

![添加版本信息图](..\resource\versionInfoImg\添加版本信息图.png)

![添加版本信息后展示](..\resource\versionInfoImg\添加版本信息后展示.png)

## 3、版本信息发布

* 版本发布的本质是把版本加入到对应的组，因此选择组至关重要。
* 点击一个版本后面的**发布**按钮，以对当前选择的版本数据进行发布（**注：灰度发布比例数据不能超过10000**），通过页面上的两个开关控制是否进行**灰度发布**和是否进行**外发**。当选择的组为**线上分组**时，表示要把版本发放到**线上分组**中，这个时候需要走**审批流程**，同时**发布版本策略**的页面上会提示“**该版本发布到线上分组需要走审批流程，请等待审批通过**”字样。选择好发布策略之后，如果同时选择灰度发布和外发，则在灰度发布的同时进一步发到外网上。点击**确定**按钮，提示发布成功和外发成功，并进入审批流，此时一级审批人会收到**小米办公审批机器人**推送的审批消息，当一级审批人审批同意时，审批会流转到二级审批人。当审批人全部通过时，版本才能正式发放到线上分组中。我们可以在**发布概览（组维度）**页面查看版本发布的审批情况，当审批状态为“通过”时，分发状态为“正常”状态，可以控制版本继续发放或暂停发放；当审批状态为“审批中”时，分发状态为“未开始”状态；当审批状态为“非通过”状态时，均视为审批不通过，分发状态仍然为“未开始”状态。
* 附：在这个审批流程中，一级审批为申请人的直属上级，二级审批为添加部署时填入的业务审批人。审批状态分为审批中、通过、拒绝、撤回和删除这五种状态，只要不是审批通过的状态，均认为此次审批不通过，无法将版本发放到线上分组中。申请人发起审批后，为审批中状态；任一审批人拒绝后，为拒绝状态；审批流程中所有人都同意后，为审批通过状态；申请人撤回审批后，为取消状态；审批定义被管理员删除后，为删除状态。

![版本发到线上分组图](..\resource\versionInfoImg\版本发到线上分组图.png)

![版本发布审批流](..\resource\versionInfoImg\版本发布审批流.png)

![版本发到线上分组审批状态1](..\resource\versionInfoImg\版本发到线上分组审批状态1.png)

![一级审批通过待二级审批](..\resource\versionInfoImg\一级审批通过待二级审批.png)

![二级审批通过](..\resource\versionInfoImg\二级审批通过.png)

![版本发到线上分组审批状态2](..\resource\versionInfoImg\版本发到线上分组审批状态2.png)

* 当把版本加入到**自定义分组**时候，不需要走审批流程，直接点击一个版本后面的**发布**按钮，对当前选择的版本数据进行发布，通过页面上的两个开关控制是否进行**灰度发布**和是否进行**外发**，如果同时选择灰度发布和外发，则在灰度发布的同时进一步发到外网上，并提示发布成功和外发成功。

![发布版本信息图](..\resource\versionInfoImg\发布版本信息图.png)


* 如果一个版本想要发布的对应的部署已经被删除，那么当前版本就不能发布，点击**发布**按钮时，页面上会弹出提示“该版本基于的部署信息已被删除，不能发布”。如果想要发布版本，需要重新去部署管理页面添加一条当前版本基于的部署数据（参照[部署管理](..\UserGuides\deploymentInfo.md)添加部署信息）。

![发布版本信息提示图](..\resource\versionInfoImg\发布版本信息提示图.png)

## 4、删除版本信息

* 点击一个版本后面的**删除**按钮，可以选择是否永久删除该版本，如果点击确定，则会把版本信息进行删除；也可以勾选版本数据前面的复选框来对版本信息进行批量删除。（**注：此处删除只能删除不在组配置表里的版本即没有发布的版本，如果一个版本已经在组配置表中（已经发布），那么就提示当前版本id不能被删除**）。

![删除版本信息图](..\resource\versionInfoImg\删除版本信息图.png)
